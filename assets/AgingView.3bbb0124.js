import{I as E}from"./ImageClicker.463117f9.js";import{_ as j,a as v,b as d,j as P,w as s,c as g,t as V,h,r as u,k as I,l as B,d as n,e as l,p as O,f as R,i as p}from"./index.92c890c7.js";import{j as T}from"./jquery.csv.735a33b9.js";const W={position:["bottomCenter"]},q={setup(t){const{columns:o,data:c}=t;return{pagination:W,columns:o,data:c}},props:{columns:{type:Array,default:[{name:"name",dataIndex:"name",key:"name"},{title:"Super class",dataIndex:"superclass",key:"superclass"},{title:"Foldchange (young vs aged)",dataIndex:"foldchange",key:"foldchange"},{title:"P value",dataIndex:"pVal",key:"pVal"}]},data:Array}},z={key:0},Y={key:1};function $(t,o,c,e,f,C){const y=v("a-table");return d(),P(y,{columns:c.columns,"data-source":c.data,pagination:e.pagination,class:"ant-table-striped","row-class-name":(i,a)=>a%2===1?"table-striped":null,scroll:{x:480,y:600}},{headerCell:s(({column:i})=>[]),bodyCell:s(({column:i,record:a})=>[i.key==="name"?(d(),g("span",z,V(a.name),1)):i.key==="value"?(d(),g("span",Y,V(a.value),1)):h("",!0)]),_:1},8,["columns","data-source","pagination","row-class-name"])}var G=j(q,[["render",$]]);const H={components:{ImageClicker:E,Analysis5Table:G},setup(){const t=u(""),o=u(""),c=u("UP"),e=u("0.01"),f=u("All"),C=u([]),y=u([]),i=u(!1),a=u(!1),k=[{name:"name",dataIndex:"name",key:"name"},{title:"Enrichment Ratio",dataIndex:"ratio",key:"ratio",width:"180px"}],A=r=>{t.value="",t.value=r,o.value=`/imgs/analysis/5/volcano/${r}.png`},x=I(()=>t.value!==""),_=I(()=>`/datas/5/diff/${t.value}_${c.value}_FC_${f.value}_P_${e.value.substring(2,4)}.csv`),D=I(()=>`/datas/5/tables/${t.value}_${c.value}_FC_${f.value}_P_${e.value.substring(2,4)}.csv`),U=I(()=>`/datas/5/figure/${t.value}_${c.value}_FC_${f.value}_P_${e.value.substring(2,4)}.png`),F=async()=>{if(!x)return;a.value=!0;const r=await fetch(_.value);if(r.status===200){const w=await r.text(),S=T.exports.toObjects(w);C.value=S.map(m=>({name:m[""],foldchange:m["Foldchange (young vs aged)"],superclass:m["Super class"],pVal:m["P value"]}))}a.value=!1},N=async()=>{i.value=!0;const r=await fetch(D.value);if(r.status===200){const w=await r.text(),S=T.exports.toObjects(w);y.value=S.map(m=>({name:m[""],ratio:parseFloat(m["Enrichment Ratio"]).toExponential(2)}))}};return B(_,(r,w)=>{r!==w&&F()}),{cellType:t,setCellType:A,imgUrl:o,isSelected:x,regulate:c,pVal:e,fondchange:f,showTable1:F,table1Data:C,showFigure:i,imagePath:U,enrichmentAnalysis:N,table2Columns:k,table2Data:y,loading:a}}},b=t=>(O("data-v-29b2170a"),t=t(),R(),t),J={class:"marker-layout"},K=b(()=>n("h1",null,"Aging landscape",-1)),L={class:"select-area-1"},M={class:"result"},Q=b(()=>n("h2",null,"Result",-1)),X={class:"container"},Z={key:0,class:"tips"},ee={key:0,class:"panel"},ae={class:"show"},te={class:"filter-panel"},le={class:"filter"},se=b(()=>n("span",null,"Filter: ",-1)),ne=b(()=>n("span",null,"Regulate ",-1)),oe=p("UP"),ce=p("DOWN"),ie=b(()=>n("span",null,"P ",-1)),re=p("0.05"),de=p("0.01"),ue=b(()=>n("span",null,"Foldchange ",-1)),_e=p("All"),pe=p("1.5"),me=p("2"),ve=p("Enrichment analysis"),he={class:"show-panel"},fe={key:0,class:"img-result"};function ye(t,o,c,e,f,C){const y=v("image-clicker"),i=v("a-image"),a=v("a-select-option"),k=v("a-select"),A=v("a-button"),x=v("analysis-5-table");return d(),g("div",J,[K,n("div",L,[l(y,{"set-cell-type":e.setCellType},null,8,["set-cell-type"]),n("div",M,[Q,n("div",X,[e.isSelected?h("",!0):(d(),g("div",Z," Note: Select the cell type of interest and you can view the volcano map of the differential metabolites. You can also obtain enrichment results of these metabolites. ")),e.isSelected?(d(),P(i,{key:1,src:e.imgUrl},null,8,["src"])):h("",!0)])])]),e.isSelected?(d(),g("div",ee,[n("div",ae,"Differential metabolites in "+V(e.cellType),1),n("div",te,[n("div",le,[se,ne,l(k,{ref:"select",value:e.regulate,"onUpdate:value":o[0]||(o[0]=_=>e.regulate=_),class:"select"},{default:s(()=>[l(a,{value:"UP"},{default:s(()=>[oe]),_:1}),l(a,{value:"DOWN"},{default:s(()=>[ce]),_:1})]),_:1},8,["value"]),ie,l(k,{ref:"select",value:e.pVal,"onUpdate:value":o[1]||(o[1]=_=>e.pVal=_),class:"select"},{default:s(()=>[l(a,{value:"0.05"},{default:s(()=>[re]),_:1}),l(a,{value:"0.01"},{default:s(()=>[de]),_:1})]),_:1},8,["value"]),ue,l(k,{ref:"select",value:e.fondchange,"onUpdate:value":o[2]||(o[2]=_=>e.fondchange=_),class:"select"},{default:s(()=>[l(a,{value:"All"},{default:s(()=>[_e]),_:1}),l(a,{value:"1.5"},{default:s(()=>[pe]),_:1}),l(a,{value:"2"},{default:s(()=>[me]),_:1})]),_:1},8,["value"])]),l(A,{type:"primary",class:"submit-button",onClick:e.enrichmentAnalysis},{default:s(()=>[ve]),_:1},8,["onClick"])])])):h("",!0),e.isSelected?(d(),P(x,{key:1,data:e.table1Data,loading:e.loading},null,8,["data","loading"])):h("",!0),n("div",he,[e.showFigure?(d(),g("div",fe,[l(i,{src:e.imagePath},null,8,["src"])])):h("",!0),e.showFigure?(d(),P(x,{key:1,data:e.table2Data,columns:e.table2Columns,class:"table-result"},null,8,["data","columns"])):h("",!0)])])}var xe=j(H,[["render",ye],["__scopeId","data-v-29b2170a"]]);export{xe as default};
